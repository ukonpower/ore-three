var g=Object.defineProperty;var h=(d,e,r)=>e in d?g(d,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[e]=r;var t=(d,e,r)=>(h(d,typeof e!="symbol"?e+"":e,r),r);import{U as l,W as f,L as c,T as A,R as T,N as m,V as S,B as y,A as _,D as p,M as u,a as b,b as M,P as R,S as C,C as E}from"./Uniforms.1c993ea0.js";import{P as x}from"./index.38a0fe2c.js";const D=`#define GLSLIFY 1
varying vec2 vUv;uniform sampler2D backbuffer;uniform vec2 resolution;uniform bool direction;uniform float gaussVar;uniform float blurRange;uniform float renderCount;uniform float count;vec4 blur13(sampler2D image,vec2 uv,vec2 resolution,vec2 direction){vec4 color=vec4(0.0);vec2 off1=vec2(1.411764705882353)*direction;vec2 off2=vec2(3.2941176470588234)*direction;vec2 off3=vec2(5.176470588235294)*direction;color+=texture2D(image,uv)*0.1964825501511404;color+=texture2D(image,uv+(off1/resolution))*0.2969069646728344;color+=texture2D(image,uv-(off1/resolution))*0.2969069646728344;color+=texture2D(image,uv+(off2/resolution))*0.09447039785044732;color+=texture2D(image,uv-(off2/resolution))*0.09447039785044732;color+=texture2D(image,uv+(off3/resolution))*0.010381362401148057;color+=texture2D(image,uv-(off3/resolution))*0.010381362401148057;return color;}void main(){vec4 c=blur13(backbuffer,vUv,resolution,(direction ? vec2(1.0,0.0): vec2(0.0,1.0))*blurRange*pow((count/renderCount)*2.0,2.0));gl_FragColor=c;}`,P=`#define GLSLIFY 1
uniform sampler2D sceneTex;uniform vec2 resolution;varying vec2 vUv;uniform float threshold;void main(){vec3 c=texture2D(sceneTex,vUv).xyz;vec3 f;f.x=max(0.0,c.x-threshold);f.y=max(0.0,c.y-threshold);f.z=max(0.0,c.z-threshold);gl_FragColor=vec4(vec3(c)*f,1.0);}`,U=`#define GLSLIFY 1
varying vec2 vUv;varying vec4 vOffset[3];uniform vec4 SMAA_RT_METRICS;void SMAAEdgeDetectionVS(vec2 texcoord){vOffset[0]=mad(SMAA_RT_METRICS.xyxy,vec4(-1.0,0.0,0.0,-1.0),texcoord.xyxy);vOffset[1]=mad(SMAA_RT_METRICS.xyxy,vec4(1.0,0.0,0.0,1.0),texcoord.xyxy);vOffset[2]=mad(SMAA_RT_METRICS.xyxy,vec4(-2.0,0.0,0.0,-2.0),texcoord.xyxy);}void main(void){vec3 pos=position;gl_Position=vec4(position,1.0);SMAAEdgeDetectionVS(uv);vUv=uv;}`,w=`#define GLSLIFY 1
varying vec2 vUv;varying vec4 vOffset[3];uniform sampler2D sceneTex;vec2 SMAAColorEdgeDetectionPS(vec2 texcoord,vec4 offset[3],sampler2D colorTex){vec2 threshold=vec2(SMAA_THRESHOLD,SMAA_THRESHOLD);vec4 delta;vec3 C=texture2D(colorTex,texcoord).rgb;vec3 Cleft=texture2D(colorTex,offset[0].xy).rgb;vec3 t=abs(C-Cleft);delta.x=max(max(t.r,t.g),t.b);vec3 Ctop=texture2D(colorTex,offset[0].zw).rgb;t=abs(C-Ctop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0,1.0))==0.0)return vec2(0.0);vec3 Cright=texture2D(colorTex,offset[1].xy).rgb;t=abs(C-Cright);delta.z=max(max(t.r,t.g),t.b);vec3 Cbottom=texture2D(colorTex,offset[1].zw).rgb;t=abs(C-Cbottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 Cleftleft=texture2D(colorTex,offset[2].xy).rgb;t=abs(C-Cleftleft);delta.z=max(max(t.r,t.g),t.b);vec3 Ctoptop=texture2D(colorTex,offset[2].zw).rgb;t=abs(C-Ctoptop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);return edges;}void main(void){gl_FragColor=vec4(SMAAColorEdgeDetectionPS(vUv,vOffset,sceneTex),0.0,0.0);}`,z=`#define GLSLIFY 1
varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;uniform vec4 SMAA_RT_METRICS;void SMAABlendingWeightCalculationVS(vec2 texcoord){vPixcoord=texcoord*SMAA_RT_METRICS.zw;vOffset[0]=mad(SMAA_RT_METRICS.xyxy,vec4(-0.25,-0.125,1.25,-0.125),texcoord.xyxy);vOffset[1]=mad(SMAA_RT_METRICS.xyxy,vec4(-0.125,-0.25,-0.125,1.25),texcoord.xyxy);vOffset[2]=mad(SMAA_RT_METRICS.xxyy,vec4(-2.0,2.0,-2.0,2.0)*float(SMAA_MAX_SEARCH_STEPS),vec4(vOffset[0].xz,vOffset[1].yw));}void main(void){vec3 pos=position;gl_Position=vec4(position,1.0);SMAABlendingWeightCalculationVS(uv);vUv=uv;}`,L=`#define GLSLIFY 1
varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;uniform vec4 SMAA_RT_METRICS;uniform sampler2D backbuffer;uniform sampler2D areaTex;uniform sampler2D searchTex;float round(float x){return sign(x)*floor(abs(x)+0.5);}vec2 round(vec2 value){return vec2(round(value.x),round(value.y));}vec4 texture2DOffset(sampler2D tex,vec2 uv,vec2 offset){return texture2D(tex,uv+offset*SMAA_RT_METRICS.xy);}float SMAASearchLength(sampler2D searchTex,vec2 e,float bias,float scale){e.r=mad(scale,e.r,bias);return SMAA_SEARCHTEX_SELECT(texture2D(searchTex,e,0.0));}float SMAASearchXLeft(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord=mad(-vec2(2.0,0.0),SMAA_RT_METRICS.xy,texcoord);if(!(texcoord.x>end&&e.g>0.8281&&e.r==0.0))break;}float offset=mad(-255.0,SMAASearchLength(searchTex,e,0.0,0.5),3.25);return mad(SMAA_RT_METRICS.x,offset,texcoord.x);}float SMAASearchXRight(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord=mad(vec2(2.0,0.0),SMAA_RT_METRICS.xy,texcoord);if(!(texcoord.x<end&&e.g>0.8281&&e.r==0.0))break;}float offset=mad(-255.0,SMAASearchLength(searchTex,e,0.5,0.5),3.25);return mad(-SMAA_RT_METRICS.x,offset,texcoord.x);}float SMAASearchYUp(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord=mad(-vec2(0.0,2.0),SMAA_RT_METRICS.xy,texcoord);if(!(texcoord.y>end&&e.r>0.8281&&e.g==0.0))break;}float offset=mad(-255.0,SMAASearchLength(searchTex,e.gr,0.0,0.5),3.25);return mad(SMAA_RT_METRICS.y,offset,texcoord.y);}float SMAASearchYDown(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord=mad(vec2(0.0,2.0),SMAA_RT_METRICS.xy,texcoord);if(!(texcoord.y<end&&e.r>0.8281&&e.g==0.0))break;}float offset=mad(-255.0,SMAASearchLength(searchTex,e.gr,0.5,0.5),3.25);return mad(-SMAA_RT_METRICS.y,offset,texcoord.y);}vec2 SMAAArea(sampler2D areaTex,vec2 dist,float e1,float e2,float offset){vec2 texcoord=mad(vec2(SMAA_AREATEX_MAX_DISTANCE,SMAA_AREATEX_MAX_DISTANCE),round(4.0*vec2(e1,e2)),dist);texcoord=mad(SMAA_AREATEX_PIXEL_SIZE,texcoord,0.5*SMAA_AREATEX_PIXEL_SIZE);texcoord.y=mad(SMAA_AREATEX_SUBTEX_SIZE,offset,texcoord.y);return SMAA_AREATEX_SELECT(texture2D(areaTex,texcoord));}vec4 SMAABlendingWeightCalculationPS(vec2 texcoord,vec2 pixcoord,vec4 offset[3],sampler2D edgesTex,sampler2D areaTex,sampler2D searchTex,ivec4 subsampleIndices){vec4 weights=vec4(0.0,0.0,0.0,0.0);vec2 e=texture2D(edgesTex,texcoord).rg;if(e.g>0.0){vec2 d;vec3 coords;coords.x=SMAASearchXLeft(edgesTex,searchTex,offset[0].xy,offset[2].x);coords.y=offset[1].y;d.x=coords.x;float e1=texture2D(edgesTex,coords.xy,0.0).r;coords.z=SMAASearchXRight(edgesTex,searchTex,offset[0].zw,offset[2].y);d.y=coords.z;d=abs(round(mad(SMAA_RT_METRICS.zz,d,-pixcoord.xx)));vec2 sqrt_d=sqrt(d);float e2=texture2DOffset(edgesTex,coords.zy,vec2(1,0)).r;weights.rg=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.y));}if(e.r>0.0){vec2 d;vec3 coords;coords.y=SMAASearchYUp(edgesTex,searchTex,offset[1].xy,offset[2].z);coords.x=offset[0].x;d.x=coords.y;float e1=texture2D(edgesTex,coords.xy).g;coords.z=SMAASearchYDown(edgesTex,searchTex,offset[1].zw,offset[2].w);d.y=coords.z;d=abs(round(mad(SMAA_RT_METRICS.ww,d,-pixcoord.yy)));vec2 sqrt_d=sqrt(d);float e2=texture2DOffset(edgesTex,coords.xz,vec2(0,1)).g;weights.ba=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.x));}return weights;}void main(void){gl_FragColor=SMAABlendingWeightCalculationPS(vUv,vPixcoord,vOffset,backbuffer,areaTex,searchTex,ivec4(0.0));}`,I=`#define GLSLIFY 1
varying vec2 vUv;varying vec4 vOffset;uniform sampler2D backbuffer;uniform vec2 resolution;uniform vec4 SMAA_RT_METRICS;void SMAANeighborhoodBlendingVS(vec2 texcoord){vOffset=mad(SMAA_RT_METRICS.xyxy,vec4(1.0,0.0,0.0,1.0),texcoord.xyxy);}void main(void){vec3 pos=position;gl_Position=vec4(position,1.0);SMAANeighborhoodBlendingVS(uv);vUv=uv;}`,B=`#define GLSLIFY 1
varying vec2 vUv;varying vec4 vOffset;uniform sampler2D backbuffer;uniform sampler2D sceneTex;uniform vec2 resolution;uniform vec4 SMAA_RT_METRICS;void SMAAMovc(vec2 cond,inout vec2 variable,vec2 value){if(cond.x>0.0)variable.x=value.x;if(cond.y>0.0)variable.y=value.y;}void SMAAMovc(vec4 cond,inout vec4 variable,vec4 value){SMAAMovc(cond.xy,variable.xy,value.xy);SMAAMovc(cond.zw,variable.zw,value.zw);}vec4 SMAANeighborhoodBlendingPS(vec2 texcoord,vec4 offset,sampler2D colorTex,sampler2D blendTex){vec4 a;a.x=texture2D(blendTex,offset.xy).a;a.y=texture2D(blendTex,offset.zw).g;a.wz=texture2D(blendTex,texcoord).xz;if(dot(a,vec4(1.0,1.0,1.0,1.0))<1e-5){vec4 color=texture2D(colorTex,texcoord);return color;}else{float h=max(a.x,a.z)>max(a.y,a.w)? 1.0 : 0.0;vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;SMAAMovc(vec4(h,h,h,h),blendingOffset,vec4(a.x,0.0,a.z,0.0));SMAAMovc(vec2(h,h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0,1.0));vec4 blendingCoord=mad(blendingOffset,vec4(SMAA_RT_METRICS.xy,-SMAA_RT_METRICS.xy),texcoord.xyxy);vec4 color;color+=blendingWeight.x*texture2D(colorTex,blendingCoord.xy);color+=blendingWeight.y*texture2D(colorTex,blendingCoord.zw);return color;}}void main(void){gl_FragColor=SMAANeighborhoodBlendingPS(vUv,vOffset,sceneTex,backbuffer);}`,O=`#define GLSLIFY 1
varying vec2 vUv;uniform sampler2D backbuffer;uniform vec2 resolution;uniform sampler2D sceneTex;uniform sampler2D lensTex;uniform sampler2D bloomTexs[RENDER_COUNT];uniform sampler2D noiseTex;uniform float brightness;uniform float time;float random(vec2 p){return fract(sin(dot(p.xy,vec2(12.9898,78.233)))*43758.5453);}void main(){vec3 c=vec3(0.0);vec2 uv=vUv;vec2 cuv=vUv*2.0-1.0;float w=max(.0,length(cuv))*0.02;float slide;vec2 rUV;vec2 gUV;vec2 bUV;
#pragma unroll_loop_start
for(int i=0;i<3;i++){slide=float(UNROLLED_LOOP_INDEX)/5.0;rUV=uv+vec2(0.0,0.0)*slide;gUV=uv+vec2(0.0025,0.0)*slide;bUV=uv+vec2(0.005,0.0)*slide;c.x+=texture2D(sceneTex,rUV).x;c.y+=texture2D(sceneTex,gUV).y;c.z+=texture2D(sceneTex,bUV).z;}
#pragma unroll_loop_end
c/=float(3);
#pragma unroll_loop_start
for(int i=0;i<RENDER_COUNT;i++){c+=texture2D(bloomTexs[UNROLLED_LOOP_INDEX],vUv).xyz*pow(2.0,float(UNROLLED_LOOP_INDEX))*brightness;}
#pragma unroll_loop_end
c+=random(uv)*0.1*c;c*=smoothstep(-1.5,0.5,1.0-length(cuv));gl_FragColor=vec4(c,1.0);}`;class F{constructor(e,r=.5,a=5,n){t(this,"commonUniforms");t(this,"smaaCommonUni");t(this,"renderer");t(this,"inputTextures");t(this,"bloomResolutionRatio");t(this,"bloomRenderCount");t(this,"bloomBrightPP");t(this,"bloomBlurPP");t(this,"smaaEdgePP");t(this,"smaaCalcWeighttPP");t(this,"smaaBlendingPP");t(this,"compositePP");t(this,"renderTargets");this.renderer=e,this.bloomResolutionRatio=r,this.bloomRenderCount=a,this.commonUniforms=l.mergeUniforms(n,{}),this.renderTargets={rt1:new f(0,0,{stencilBuffer:!1,generateMipmaps:!1,depthBuffer:!0,minFilter:c,magFilter:c}),rt2:new f(0,0,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:c,magFilter:c}),rt3:new f(0,0,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:c,magFilter:c})};for(let o=0;o<this.bloomRenderCount;o++)this.renderTargets["rtBlur"+o.toString()+"_0"]=new f(0,0,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:c,magFilter:c}),this.renderTargets["rtBlur"+o.toString()+"_1"]=new f(0,0,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:c,magFilter:c});this.inputTextures={areaTex:{value:null},searchTex:{value:null},envMap:{value:null}};const s=new A;s.load("./assets/smaa/smaa-area.png",o=>{o.minFilter=c,o.generateMipmaps=!1,o.format=T,o.flipY=!1,this.inputTextures.areaTex.value=o}),s.load("./assets/smaa/smaa-search.png",o=>{o.minFilter=m,o.magFilter=m,o.generateMipmaps=!1,o.flipY=!1,this.inputTextures.searchTex.value=o}),this.bloomBrightPP=new x(this.renderer,{fragmentShader:P,uniforms:l.mergeUniforms(this.commonUniforms,{threshold:{value:.5}})}),this.bloomBlurPP=new x(this.renderer,{fragmentShader:D,uniforms:l.mergeUniforms(this.commonUniforms,{backbuffer:{value:null},blurRange:{value:1},renderCount:{value:this.bloomRenderCount},count:{value:0},direction:{value:!1}})});const v={"mad(a, b, c)":"(a * b + c)",SMAA_THRESHOLD:"0.1",SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )","SMAA_SEARCHTEX_SELECT(sample)":"sample.g","SMAA_AREATEX_SELECT(sample)":"sample.rg"};this.smaaCommonUni=l.mergeUniforms(this.commonUniforms,{SMAA_RT_METRICS:{value:new S}}),this.smaaEdgePP=new x(this.renderer,{vertexShader:U,fragmentShader:w,uniforms:l.mergeUniforms(this.smaaCommonUni,{}),defines:v}),this.smaaCalcWeighttPP=new x(this.renderer,{vertexShader:z,fragmentShader:L,uniforms:l.mergeUniforms(this.smaaCommonUni,{areaTex:this.inputTextures.areaTex,searchTex:this.inputTextures.searchTex}),defines:v}),this.smaaBlendingPP=new x(this.renderer,{vertexShader:I,fragmentShader:B,uniforms:l.mergeUniforms(this.smaaCommonUni,{}),defines:v});const i=O.replace(/RENDER_COUNT/g,this.bloomRenderCount.toString());this.compositePP=new x(this.renderer,{fragmentShader:i,uniforms:l.mergeUniforms(this.commonUniforms,{brightness:{value:.08}}),defines:{RENDER_COUNT:this.bloomRenderCount.toString()}})}render(e,r){const a=this.renderer.getRenderTarget();this.renderer.setRenderTarget(this.renderTargets.rt1),this.renderer.render(e,r),this.renderer.setRenderTarget(a),this.renderer.autoClear=!1,this.bloomBrightPP.render({sceneTex:this.renderTargets.rt1.texture},this.renderTargets.rt2);let n;const s=this.bloomBlurPP.effect.material.uniforms;s.backbuffer.value=this.renderTargets.rt2.texture;for(let i=0;i<this.bloomRenderCount;i++)s.count.value=i,s.direction.value=!1,n=this.renderTargets["rtBlur"+i.toString()+"_0"],this.bloomBlurPP.render(null,n),s.direction.value=!0,s.backbuffer.value=n.texture,n=this.renderTargets["rtBlur"+i.toString()+"_1"],this.bloomBlurPP.render(null,n),s.backbuffer.value=n.texture;this.smaaEdgePP.render({sceneTex:this.renderTargets.rt1.texture},this.renderTargets.rt2),this.smaaCalcWeighttPP.render({backbuffer:this.renderTargets.rt2.texture},this.renderTargets.rt3),this.smaaBlendingPP.render({sceneTex:this.renderTargets.rt1.texture,backbuffer:this.renderTargets.rt3.texture},this.renderTargets.rt2);const v={sceneTex:this.renderTargets.rt2.texture,bloomTexs:[]};for(let i=0;i<this.bloomRenderCount;i++)v.bloomTexs.push(this.renderTargets["rtBlur"+i.toString()+"_1"].texture);this.compositePP.render(v,null),this.renderer.autoClear=!0}resize(e){this.smaaCommonUni.SMAA_RT_METRICS.value.set(1/e.x,1/e.y,e.x,e.y),this.renderTargets.rt1.setSize(e.x,e.y),this.renderTargets.rt2.setSize(e.x,e.y),this.renderTargets.rt3.setSize(e.x,e.y);for(let r=0;r<this.bloomRenderCount;r++){const a=e.clone().multiplyScalar(this.bloomResolutionRatio);a.divideScalar((r+1)*2),this.renderTargets["rtBlur"+r.toString()+"_0"].setSize(a.x,a.y),this.renderTargets["rtBlur"+r.toString()+"_1"].setSize(a.x,a.y)}}}const X=`#define GLSLIFY 1
varying vec2 vUv;void main(void){vec3 pos=position;gl_Position=vec4(pos.xy,0.99,1.0);vUv=uv;}`,N=`#define GLSLIFY 1
varying vec2 vUv;uniform float time;vec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}float snoise3D(vec3 v){const vec2 C=vec2(1.0/6.0,1.0/3.0);const vec4 D=vec4(0.0,0.5,1.0,2.0);vec3 i=floor(v+dot(v,C.yyy));vec3 x0=v-i+dot(i,C.xxx);vec3 g=step(x0.yzx,x0.xyz);vec3 l=1.0-g;vec3 i1=min(g.xyz,l.zxy);vec3 i2=max(g.xyz,l.zxy);vec3 x1=x0-i1+C.xxx;vec3 x2=x0-i2+C.yyy;vec3 x3=x0-D.yyy;i=mod289(i);vec4 p=permute(permute(permute(i.z+vec4(0.0,i1.z,i2.z,1.0))+i.y+vec4(0.0,i1.y,i2.y,1.0))+i.x+vec4(0.0,i1.x,i2.x,1.0));float n_=0.142857142857;vec3 ns=n_*D.wyz-D.xzx;vec4 j=p-49.0*floor(p*ns.z*ns.z);vec4 x_=floor(j*ns.z);vec4 y_=floor(j-7.0*x_);vec4 x=x_*ns.x+ns.yyyy;vec4 y=y_*ns.x+ns.yyyy;vec4 h=1.0-abs(x)-abs(y);vec4 b0=vec4(x.xy,y.xy);vec4 b1=vec4(x.zw,y.zw);vec4 s0=floor(b0)*2.0+1.0;vec4 s1=floor(b1)*2.0+1.0;vec4 sh=-step(h,vec4(0.0));vec4 a0=b0.xzyw+s0.xzyw*sh.xxyy;vec4 a1=b1.xzyw+s1.xzyw*sh.zzww;vec3 p0=vec3(a0.xy,h.x);vec3 p1=vec3(a0.zw,h.y);vec3 p2=vec3(a1.xy,h.z);vec3 p3=vec3(a1.zw,h.w);vec4 norm=taylorInvSqrt(vec4(dot(p0,p0),dot(p1,p1),dot(p2,p2),dot(p3,p3)));p0*=norm.x;p1*=norm.y;p2*=norm.z;p3*=norm.w;vec4 m=max(0.6-vec4(dot(x0,x0),dot(x1,x1),dot(x2,x2),dot(x3,x3)),0.0);m=m*m;return 42.0*dot(m*m,vec4(dot(p0,x0),dot(p1,x1),dot(p2,x2),dot(p3,x3)));}void main(){vec3 c=vec3(0.3,0.3,1.0);float t=time;vec2 uv=vUv;t*=0.1;uv*=0.5;float n=snoise3D(vec3(uv,t))*0.5;c-=n;c*=0.8;gl_FragColor=vec4(c,1.0);}`;class k extends y{constructor(){super();t(this,"isExamplePage",!1);t(this,"spWeight",0);t(this,"box");t(this,"renderPipeline");this.commonUniforms=l.mergeUniforms(this.commonUniforms,{objTransform:{value:0},objSelector:{value:0},spWeight:{value:0},dark:{value:0}}),this.isExamplePage=window.location.href.indexOf("examples")!=-1;const r=document.querySelector(".ui-menu-button");r&&r.addEventListener("click",a=>{document.body.setAttribute("data-menu-open",document.body.getAttribute("data-menu-open")=="true"?"false":"true")})}onBind(r){super.onBind(r);const a=new _;a.intensity=.4,this.scene.add(a);const n=new p;n.intensity=.7,n.position.set(.1,10,2),this.scene.add(n),this.box=new u(new b,new M),this.scene.add(this.box);const s=new u(new R(2,2),new C({vertexShader:X,fragmentShader:N,uniforms:this.commonUniforms}));this.scene.add(s),this.camera.position.set(0,1,5),this.camera.lookAt(0,0,0),this.renderer&&(this.renderPipeline=new F(this.renderer)),this.dispatchEvent({type:"createdRenderer",renderer:this.renderer})}animate(r){this.box&&(this.box.rotation.y=this.time),this.renderPipeline&&this.renderPipeline.render(this.scene,this.camera)}onResize(){super.onResize(),this.spWeight=Math.min(1,Math.max(0,(this.info.size.windowSize.x-500)/1e3)),this.commonUniforms.spWeight.value=this.spWeight,this.renderPipeline&&this.renderPipeline.resize(this.info.size.canvasPixelSize)}}class V{constructor(){t(this,"controller");t(this,"scene");this.controller=new E,this.scene=new k,this.controller.addLayer(this.scene,{name:"Main",canvas:document.querySelector("#canvas")})}}window.addEventListener("load",()=>{new V});
