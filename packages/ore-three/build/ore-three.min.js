/*! For license information please see ore-three.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("three")):"function"==typeof define&&define.amd?define(["three"],t):"object"==typeof exports?exports.ORE=t(require("three")):e.ORE=t(e.THREE)}(this,(e=>(()=>{var t={302:function(e,t,i){var n;!function(t){"use strict";function s(){}var r=s.prototype,o=t.EventEmitter;function a(e,t){for(var i=e.length;i--;)if(e[i].listener===t)return i;return-1}function l(e){return function(){return this[e].apply(this,arguments)}}function h(e){return"function"==typeof e||e instanceof RegExp||!(!e||"object"!=typeof e)&&h(e.listener)}r.getListeners=function(e){var t,i,n=this._getEvents();if(e instanceof RegExp)for(i in t={},n)n.hasOwnProperty(i)&&e.test(i)&&(t[i]=n[i]);else t=n[e]||(n[e]=[]);return t},r.flattenListeners=function(e){var t,i=[];for(t=0;t<e.length;t+=1)i.push(e[t].listener);return i},r.getListenersAsObject=function(e){var t,i=this.getListeners(e);return i instanceof Array&&((t={})[e]=i),t||i},r.addListener=function(e,t){if(!h(t))throw new TypeError("listener must be a function");var i,n=this.getListenersAsObject(e),s="object"==typeof t;for(i in n)n.hasOwnProperty(i)&&-1===a(n[i],t)&&n[i].push(s?t:{listener:t,once:!1});return this},r.on=l("addListener"),r.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},r.once=l("addOnceListener"),r.defineEvent=function(e){return this.getListeners(e),this},r.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},r.removeListener=function(e,t){var i,n,s=this.getListenersAsObject(e);for(n in s)s.hasOwnProperty(n)&&-1!==(i=a(s[n],t))&&s[n].splice(i,1);return this},r.off=l("removeListener"),r.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},r.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},r.manipulateListeners=function(e,t,i){var n,s,r=e?this.removeListener:this.addListener,o=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(n=i.length;n--;)r.call(this,t,i[n]);else for(n in t)t.hasOwnProperty(n)&&(s=t[n])&&("function"==typeof s?r.call(this,n,s):o.call(this,n,s));return this},r.removeEvent=function(e){var t,i=typeof e,n=this._getEvents();if("string"===i)delete n[e];else if(e instanceof RegExp)for(t in n)n.hasOwnProperty(t)&&e.test(t)&&delete n[t];else delete this._events;return this},r.removeAllListeners=l("removeEvent"),r.emitEvent=function(e,t){var i,n,s,r,o=this.getListenersAsObject(e);for(r in o)if(o.hasOwnProperty(r))for(i=o[r].slice(0),s=0;s<i.length;s++)!0===(n=i[s]).once&&this.removeListener(e,n.listener),n.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,n.listener);return this},r.trigger=l("emitEvent"),r.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},r.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},r._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},r._getEvents=function(){return this._events||(this._events={})},s.noConflict=function(){return t.EventEmitter=o,s},void 0===(n=function(){return s}.call(t,i,t,e))||(e.exports=n)}("undefined"!=typeof window?window:this||{})},381:t=>{"use strict";t.exports=e},147:e=>{"use strict";e.exports={i8:"3.1.0"}}},i={};function n(e){var s=i[e];if(void 0!==s)return s.exports;var r=i[e]={exports:{}};return t[e].call(r.exports,r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{"use strict";n.r(s),n.d(s,{AnimationAction:()=>d,Animator:()=>h,Background:()=>g,BaseLayer:()=>o,BlenderConnector:()=>y,Controller:()=>l,DOMMesh:()=>E,Easings:()=>t,EventDispatcher:()=>w,FCurve:()=>p,FCurveGroup:()=>f,FCurveKeyFrame:()=>v,GPUComputationController:()=>S,LayoutController:()=>A,Lerps:()=>i,MouseRotator:()=>b,PageScroller:()=>P,PageScrollerSection:()=>T,Pointer:()=>a,PostProcessing:()=>x,TimelineAnimator:()=>L,UniformsLib:()=>c,WaitMan:()=>R});var e,t,i,r=n(381);class o extends r.EventDispatcher{constructor(){super(),this.readyAnimate=!1,this.time=0,this.info={name:"",aspectSetting:{mainAspect:16/9,wideAspect:10,portraitAspect:.5},size:{windowSize:new r.Vector2,windowAspectRatio:1,canvasSize:new r.Vector2,canvasPixelSize:new r.Vector2,canvasAspectRatio:1,pixelRatio:window.devicePixelRatio,portraitWeight:0,wideWeight:0}},this.commonUniforms={time:{value:0}},this.scene=new r.Scene,this.camera=new r.PerspectiveCamera(50,1,.1,1e3)}tick(e){this.time+=e,this.commonUniforms.time.value=this.time,this.readyAnimate&&this.animate(e)}animate(e){}onBind(e){this.info.name=e.name,this.info.canvas=e.canvas,e.wrapperElement&&this.setWrapperElement(e.wrapperElement||null,!1),this.info.aspectSetting=e.aspectSetting||this.info.aspectSetting,this.info.alpha=e.alpha,this.info.size.pixelRatio=e.pixelRatio||this.info.size.pixelRatio,this.renderer=new r.WebGLRenderer(this.info),this.renderer.setPixelRatio(this.info.size.pixelRatio),this.renderer.debug.checkShaderErrors=!0,this.info.canvas=this.renderer.domElement,setTimeout((()=>{this.onResize(),this.readyAnimate=!0}),0)}onUnbind(){this.dispatchEvent({type:"dispose"}),this.removeChildrens(this.scene),this.readyAnimate=!1}removeChildrens(e){for(let t=e.children.length-1;t>=0;t--){let i,n;this.removeChildrens(e.children[t]),e.children[t].isMesh&&(i=e.children[t].geometry,n=e.children[t].material),e.remove(e.children[t]),i&&i.dispose(),n&&n.dispose()}}setWrapperElement(e,t=!0){this.info.wrapperElement=e,this.info.wrapperElementRect=e?e.getBoundingClientRect():null,t&&this.onResize()}onResize(){if(null==this.renderer)return;const e=new r.Vector2(document.body.clientWidth,window.innerHeight),t=new r.Vector2;this.info.wrapperElement?t.set(this.info.wrapperElement.clientWidth,this.info.wrapperElement.clientHeight):t.copy(e);let i=1-(t.x/t.y-this.info.aspectSetting.portraitAspect)/(this.info.aspectSetting.mainAspect-this.info.aspectSetting.portraitAspect);i=Math.min(1,Math.max(0,i));let n=1-(t.x/t.y-this.info.aspectSetting.wideAspect)/(this.info.aspectSetting.mainAspect-this.info.aspectSetting.wideAspect);n=Math.min(1,Math.max(0,n)),this.info.size.windowSize.copy(e),this.info.size.windowAspectRatio=e.x/e.y,this.info.size.canvasSize.copy(t),this.info.size.canvasPixelSize.copy(t.clone().multiplyScalar(this.renderer.getPixelRatio())),this.info.size.canvasAspectRatio=t.x/t.y,this.info.size.portraitWeight=i,this.info.size.wideWeight=n,this.renderer.setPixelRatio(this.info.size.pixelRatio),this.renderer.setSize(this.info.size.canvasSize.x,this.info.size.canvasSize.y),this.camera.aspect=this.info.size.canvasAspectRatio,this.camera.updateProjectionMatrix(),this.info.wrapperElement&&(this.info.wrapperElementRect=this.info.wrapperElement.getBoundingClientRect())}pointerEvent(e){const t=new r.Vector2;if(t.copy(e.position),this.info.canvas){const e=this.info.canvas.getBoundingClientRect();t.sub(new r.Vector2(e.x,e.y))}const i=t.clone();i.divide(this.info.size.canvasSize),i.y=1-i.y,i.multiplyScalar(2).subScalar(1);const n={event:e.pointerEvent,position:t.clone(),delta:e.delta.clone(),screenPosition:i.clone(),windowPosition:e.position.clone()};"hover"==e.pointerEventType?this.onHover(n):"start"==e.pointerEventType?this.onTouchStart(n):"move"==e.pointerEventType?this.onTouchMove(n):"end"==e.pointerEventType&&this.onTouchEnd(n)}onTouchStart(e){}onTouchMove(e){}onTouchEnd(e){}onHover(e){}onWheel(e,t){}}class a extends r.EventDispatcher{constructor(){super(),this.trackpadMemDelta=0,this.trackpadMax=!1,this.position=new r.Vector2(NaN,NaN),this.delta=new r.Vector2(NaN,NaN);const e=navigator.userAgent;this.isSP=e.indexOf("iPhone")>=0||e.indexOf("iPad")>=0||e.indexOf("Android")>=0||"iPad"==navigator.platform||"MacIntel"==navigator.platform&&-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")&&void 0!==navigator.standalone,this.position.set(NaN,NaN),this.isTouching=!1}registerElement(e){const t=this.onTouch.bind(this,"start"),i=this.onTouch.bind(this,"move"),n=this.onTouch.bind(this,"end"),s=this.onPointer.bind(this,"start"),r=this.onPointer.bind(this,"move"),o=this.onPointer.bind(this,"end"),a=this.wheel.bind(this);e.addEventListener("touchstart",t,{passive:!1}),e.addEventListener("touchmove",i,{passive:!1}),e.addEventListener("touchend",n,{passive:!1}),e.addEventListener("pointerdown",s),e.addEventListener("pointermove",r),e.addEventListener("pointerup",o),e.addEventListener("dragend",o),e.addEventListener("wheel",a,{passive:!1});const l=h=>{e.isEqualNode(h.elm)&&(e.removeEventListener("touchstart",t),e.removeEventListener("touchmove",i),e.removeEventListener("touchend",n),e.removeEventListener("pointerdown",s),e.removeEventListener("pointermove",r),e.removeEventListener("pointerup",o),e.removeEventListener("dragend",o),e.removeEventListener("wheel",a),this.removeEventListener("unregister",l))};this.addEventListener("unregister",l)}unregisterElement(e){this.dispatchEvent({type:"unregister",elm:e})}getScreenPosition(e){if(this.position.x!=this.position.x)return new r.Vector2(NaN,NaN);const t=this.position.clone().divide(e).multiplyScalar(2).subScalar(1);return t.y*=-1,t}getRelativePosition(e,t){const i=e.getClientRects()[0];let n=this.position.x-i.left,s=this.position.y-i.top;return t&&(n/=i.width,s/=i.height),new r.Vector2(n,s)}setPos(e,t){this.position.x!=this.position.x||this.position.y!=this.position.y?this.delta.set(0,0):this.delta.set(e-this.position.x,t-this.position.y),this.position.set(e,t)}onTouch(e,t){const i=t.touches[0];i?this.touchEventHandler(i.pageX,i.pageY,e,t):"end"==e&&this.touchEventHandler(NaN,NaN,e,t)}onPointer(e,t){const i=t.pointerType;null!=i&&("mouse"!=i||-1!=t.button&&0!=t.button)||this.touchEventHandler(t.pageX,t.pageY,e,t)}touchEventHandler(e,t,i,n){let s=!1;const r=e-window.pageXOffset,o=t-window.pageYOffset;"start"==i?(this.isTouching=!0,this.setPos(r,o),this.delta.set(0,0),s=!0):"move"==i?(this.setPos(r,o),this.isTouching&&(s=!0)):"end"==i&&("targetTouches"in n?0==n.targetTouches.length&&(this.isTouching=!1):this.isTouching=!1,s=!0),s&&this.dispatchEvent({type:"update",pointerEvent:n,pointerEventType:i,position:this.position.clone(),delta:this.delta.clone()})}update(){this.isSP||this.dispatchEvent({type:"update",pointerEvent:null,pointerEventType:"hover",position:this.position.clone(),delta:this.delta.clone()})}wheel(e){this.dispatchEvent({type:"wheel",wheelEvent:e})}}class l extends r.EventDispatcher{constructor(e){super(),this.layers=[],e&&e.silent||console.log("%c- ore-three "+n(147).i8+" -","padding: 5px 10px ;background-color: black; color: white;font-size:11px"),this.clock=new r.Clock,this.pointer=new a,this.setPointerEventElement(e&&e.pointerEventElement||document.body);let t=this.pointerEvent.bind(this),i=this.onWheel.bind(this),s=this.onOrientationDevice.bind(this),o=this.onWindowResize.bind(this);this.pointer.addEventListener("update",t),this.pointer.addEventListener("wheel",i),window.addEventListener("orientationchange",s),window.addEventListener("resize",o),this.addEventListener("dispose",(()=>{this.pointer.removeEventListener("update",t),this.pointer.removeEventListener("wheel",i),window.removeEventListener("orientationchange",s),window.removeEventListener("resize",o)})),this.tick()}tick(){const e=this.clock.getDelta();this.pointer.update();for(let t=0;t<this.layers.length;t++)this.layers[t].tick(e);requestAnimationFrame(this.tick.bind(this))}onWindowResize(){for(let e=0;e<this.layers.length;e++)this.layers[e].onResize()}onOrientationDevice(){this.onWindowResize()}pointerEvent(e){for(let t=0;t<this.layers.length;t++)this.layers[t].pointerEvent(e)}onWheel(e){for(let t=0;t<this.layers.length;t++)this.layers[t].onWheel(e.wheelEvent,e.trackpadDelta)}addLayer(e,t){for(;this.getLayer(t.name);)t.name+="_";this.layers.push(e),e.onBind(t)}getLayer(e){for(let t=0;t<this.layers.length;t++)if(this.layers[t].info.name==e)return this.layers[t];return null}removeLayer(e){for(let t=this.layers.length-1;t>=0;t--){const i=this.layers[t];i.info.name==e&&(i.onUnbind(),this.layers.splice(t,1))}}setPointerEventElement(e){this.pointerEventElement&&this.pointer.unregisterElement(this.pointerEventElement),this.pointer.registerElement(e),this.pointerEventElement=e}dispose(){this.layers.forEach((e=>{this.removeLayer(e.info.name)})),this.tick=()=>{},this.dispatchEvent({type:"dispose"})}}!function(e){function t(e){return-e.p0+3*e.p1-3*e.p2+e.p3}function i(e){return 3*e.p0-6*e.p1+3*e.p2}function n(e){return-3*e.p0+3*e.p1}function s(e,s){return 3*t(e)*s*s+2*i(e)*s+n(e)}function r(e,s){return((t(e)*s+i(e))*s+n(e))*s+e.p0}e.NEWTON_ITERATIONS=4,e.NEWTON_MIN_SLOPE=.001,e.SUBDIVISION_PRECISION=1e-7,e.SUBDIVISION_MAX_ITERATIONS=10,e.BEZIER_EASING_CACHE_SIZE=11,e.BEZIER_EASING_SAMPLE_STEP_SIZE=1/e.BEZIER_EASING_CACHE_SIZE,e.calcBezierSlope=s,e.calcBezier=r,e.getBezierTfromX=function(t,i,n){t.p1=Math.max(t.p0,Math.min(t.p3,t.p1)),t.p2=Math.max(t.p0,Math.min(t.p3,t.p2));let o=0;for(let e=1;e<n.length&&(o=e-1,!(i<n[e]));e++);let a=o/(e.BEZIER_EASING_CACHE_SIZE-1),l=s(t,a)/(t.p3-t.p0);return 0==l?a:l>.01?function(t,i,n){for(let o=0;o<e.NEWTON_ITERATIONS;o++){let e=s(i,n);if(0==e)return n;n-=(r(i,n)-t)/e}return n}(i,t,a):function(t,i,n,s){let o=0,a=0;for(let l=0;l<e.SUBDIVISION_MAX_ITERATIONS;l++)a=i+(n-i)/2,o=r(s,a),o>t?n=a:i=a;return a}(i,a,a+e.BEZIER_EASING_SAMPLE_STEP_SIZE,t)}}(e||(e={})),function(t){function i(t,i,n,s){for(var r=new Array(e.BEZIER_EASING_CACHE_SIZE),o=0;o<e.BEZIER_EASING_CACHE_SIZE;++o)r[o]=e.calcBezier({p0:t.x,p1:i.x,p2:n.x,p3:s.x},o/(e.BEZIER_EASING_CACHE_SIZE-1));return o=>o<=t.x?t.y:s.x<=o?s.y:e.calcBezier({p0:t.y,p1:i.y,p2:n.y,p3:s.y},e.getBezierTfromX({p0:t.x,p1:i.x,p2:n.x,p3:s.x},o,r))}t.sigmoid=function(e=6){return t=>{var i=Math.exp(-e*(2*t-1)),n=Math.exp(-e);return(1+(1-i)/(1+i)*(1+n)/(1-n))/2}},t.smoothstep=function(e,t,i){let n=Math.max(0,Math.min(1,(i-e)/(t-e)));return n*n*(3-2*n)},t.linear=function(e){return e},t.easeInQuad=function(e){return e*e},t.easeOutQuad=function(e){return e*(2-e)},t.easeInOutQuad=function(e){return e<.5?2*e*e:(4-2*e)*e-1},t.easeInCubic=function(e){return e*e*e},t.easeOutCubic=function(e){return--e*e*e+1},t.easeInOutCubic=function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},t.easeInQuart=function(e){return e*e*e*e},t.easeOutQuart=function(e){return 1- --e*e*e*e},t.easeInOutQuart=function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},t.easeInQuint=function(e){return e*e*e*e*e},t.easeOutQuint=function(e){return 1+--e*e*e*e*e},t.easeInOutQuint=function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},t.bezier=i,t.cubicBezier=function(e,t,n,s){return i({x:0,y:0},{x:e,y:t},{x:n,y:s},{x:1,y:1})}}(t||(t={})),function(e){e.number=function(e,t,i){return e+(t-e)*i},e.numberArray=function(e,t,i){if(e.length==t.length){let n=[];for(let s=0;s<e.length;s++)n.push(e[s]+(t[s]-e[s])*i);return n}return console.log("Different length Arrays!!!"),!1},e.THREEVectors=function(e,t,i){return e.clone().lerp(t,i)},e.THREEQuaternion=function(e,t,i){return e.clone().slerp(t,i)},e.THREEEuler=function(e,t,i){let n=e.clone(),s=t.clone();return n.x=n.x+(s.x-n.x)*i,n.y=n.y+(s.y-n.y)*i,n.z=n.z+(s.z-n.z)*i,n},e.getLerpFunc=function(t){return"number"==typeof t?e.number:t instanceof Array?e.numberArray:"isVector2"in t||"isVector3"in t||"isVector4"in t||"isColor"in t?e.THREEVectors:"isQuaternion"in t?e.THREEQuaternion:"isEuler"in t?e.THREEEuler:void 0}}(i||(i={}));class h extends r.EventDispatcher{constructor(){super(),this.isAnimating=!1,this.animatingCount=0,this.dispatchEvents=[],this.variables={},this.dataBase={}}add(e){let n={time:-1,value:this.getValueClone(e.initValue),startValue:this.getValueClone(e.initValue),goalValue:this.getValueClone(e.initValue),easing:e.easing||t.sigmoid(),lerpFunc:e.customLerpFunc||i.getLerpFunc(e.initValue),userData:e.userData};return this.dataBase[e.name]=n.value,this.variables[e.name]=n,this.dispatchEvent({type:"added",varName:e.name,variable:n}),n}setEasing(e,t){let i=this.variables[e];i?i.easing=t:console.warn('"'+e+'" is not exist')}setValue(e,t){let i=this.dataBase[e];if(void 0===i)return console.warn('"'+e+'" is not exist'),null;"number"==typeof i?this.dataBase[e]=t:"copy"in i?i.copy(t):i instanceof Array&&(i=t.concat()),this.updateDataBase(e),this.cancelAnimate(e)}animate(e,t,i=1,n,s){let r=this.variables[e];return new Promise((o=>{if(r){if(i<=0)return this.setValue(e,t),r.time=1,void(r.onAnimationFinished=()=>{n&&n(),o(null)});-1==r.time&&(this.isAnimating=!0,this.animatingCount++),r.time=0,r.duration=i,r.startValue=this.getValueClone(r.value),r.goalValue=this.getValueClone(t),r.onAnimationFinished=()=>{n&&n(),o(null)},s&&this.setEasing(e,s)}else console.warn('"'+e+'" is not exist')}))}cancelAnimate(e){let t=this.variables[e];t?(t.time=1,t.onAnimationFinished=null):console.warn('"'+e+'" is not exist')}get(e){return this.variables[e]?this.variables[e].value:(console.warn('"'+e+'" is not exist'),null)}getVariableObject(e,t=!1){return this.variables[e]?this.variables[e]:(t||console.warn('"'+e+'" is not exist'),null)}applyToUniforms(e){let t=Object.keys(this.variables);for(let i=0;i<t.length;i++){let n=this.getVariableObject(t[i]);n&&(e[t[i]]=n)}}isAnimatingVariable(e,t=!1){return this.variables[e]?-1!=this.variables[e].time:(t||console.warn('"'+e+'" is not exist'),null)}getValueClone(e){return"number"==typeof e?e:"clone"in e?e.clone():e instanceof Array?e.concat():e}wait(e){return new Promise((t=>{setTimeout((()=>{t()}),1e3*e)}))}update(e){0==this.animatingCount&&(this.isAnimating=!1);let t=Object.keys(this.variables);for(let i=0;i<t.length;i++){let n=t[i],s=this.variables[n],r=s.time;if(1==r&&(this.animatingCount--,r=-1,s.onAnimationFinished&&this.dispatchEvents.push(s.onAnimationFinished)),r>=0&&r<1){let o=s.duration,a=s.easing,l=s.lerpFunc;o&&(r+=(e||.016)/o,(0==o||r>=1)&&(r=1));let h=s.goalValue;r<1&&l&&(h=l(s.startValue,s.goalValue,a(r)));let c=this.dataBase[n];"number"!=typeof c&&"copy"in c?"copy"in c&&c.copy(h):this.dataBase[n]=h,this.dispatchEvent({type:"update/"+t[i],deltaTime:e,value:s.value})}s.time=r}for(;0!=this.dispatchEvents.length;){let e=this.dispatchEvents.pop();e&&e()}this.updateDataBase(),this.dispatchEvent({type:"update",deltaTime:e}),this.isAnimating&&this.dispatchEvent({type:"animate",deltaTime:e})}updateDataBase(e){if(e){let t=this.variables[e],i=this.dataBase[e];return void(t&&void 0!==i&&("number"!=typeof t.value&&"copy"in t.value||(t.value=i)))}let t=Object.keys(this.dataBase);for(let e=0;e<t.length;e++){let i=this.variables[t[e]],n=this.dataBase[t[e]];i&&void 0!==n&&("number"!=typeof i.value&&"copy"in i.value||(i.value=n))}}}var c,u=n(302),m=n.n(u);class d extends(m()){constructor(e){super(),this.curves={},this.name=e||"",this.uniforms={},this.frame={start:0,end:0,duration:0}}addFcurveGroup(e,t){this.curves[e]=t,this.calcFrame()}removeFCurve(e){delete this.curves[e],this.calcFrame()}calcFrame(){let e=Object.keys(this.curves),t=1/0,i=-1/0;for(let n=0;n<e.length;n++){let s=this.curves[e[n]];s.frameStart<t&&(t=s.frameStart),s.frameEnd>i&&(i=s.frameEnd)}t!=-1/0&&i!=1/0||(t=0,i=1),this.frame.start=t,this.frame.end=i,this.frame.duration=this.frame.end-this.frame.start}getFCurveGroup(e){return this.curves[e]||null}assignUniforms(e,t){this.uniforms[e]=t}getUniforms(e){if(this.uniforms[e])return this.uniforms[e];let t=this.getFCurveGroup(e);if(t){let i={value:t.createInitValue()};return this.uniforms[e]=i,i}return null}getValue(e,t){let i=this.getUniforms(e);if(!i)return t||null;let n=i.value;return t?"number"==typeof n?(t.x=n,t):(t.x=n.x,t.y=n.y,"z"in t&&"z"in n&&(t.z=n.z),"w"in t&&"w"in n&&(t.w=n.w),t||null):n}getValueAt(e,t,i){let n=this.getFCurveGroup(e);return i?n?n.getValue(t||0,i):i:n?n.getValue(t):null}updateFrame(e){let t=Object.keys(this.curves);for(let i=0;i<t.length;i++){let n=this.curves[t[i]],s=this.getUniforms(t[i]);s&&("number"==typeof s.value?s.value=n.getValue(e)||0:n.getValue(e,s.value))}this.emitEvent("update",[this])}}class p extends(m()){constructor(e){super(),this.keyframes=[],this.cache={frame:NaN,value:NaN},this.frameStart=0,this.frameEnd=0,this.frameDuration=0,this.set(e)}set(e){e&&(this.keyframes.length=0,e.forEach((e=>{this.addKeyFrame(e)})))}addKeyFrame(e){let t=0;for(let i=0;i<this.keyframes.length&&this.keyframes[i].coordinate.x<e.coordinate.x;i++)t++;this.keyframes.splice(t,0,e),this.frameStart=this.keyframes[0].coordinate.x,this.frameEnd=this.keyframes[this.keyframes.length-1].coordinate.x}getValue(e){if(e==this.cache.frame)return this.cache.value;let t=null;for(let i=0;i<this.keyframes.length;i++){let n=this.keyframes[i];if(e<=n.coordinate.x){let s=this.keyframes[i-1];t=s?s.to(n,e):n.coordinate.y;break}}return null===t&&this.keyframes.length>0&&(t=this.keyframes[this.keyframes.length-1].coordinate.y),null!==t?(this.cache={frame:e,value:t},t):0}}class f extends(m()){constructor(e,t,i,n,s,r){super(),this.type="scalar",this.name=e||"",this.frameStart=0,this.frameEnd=0,this.frameDuration=0,this.curve={x:null,y:null,z:null,w:null,scalar:null},t&&this.setFCurve(t,"x"),i&&this.setFCurve(i,"y"),n&&this.setFCurve(n,"z"),s&&this.setFCurve(s,"w")}setFCurve(e,t){this.curve[t]=e,this.calcType(),this.calcFrame()}calcType(){this.curve.scalar&&(this.type="scalar"),this.curve.w?this.type="vec4":this.curve.z?this.type="vec3":this.curve.y?this.type="vec2":this.curve.x&&(this.type="scalar")}calcFrame(){let e=Object.keys(this.curve),t=1/0,i=-1/0;for(let n=0;n<e.length;n++){let s=this.curve[e[n]];s&&(s.frameStart<t&&(t=s.frameStart),s.frameEnd>i&&(i=s.frameEnd))}t!=-1/0&&i!=1/0||(t=0,i=1),this.frameStart=t,this.frameEnd=i,this.frameDuration=this.frameEnd-this.frameStart}createInitValue(){return"vec2"==this.type?new r.Vector2:"vec3"==this.type?new r.Vector3:"vec4"==this.type?new r.Vector4:0}getValue(e,t){return t?(this.curve.x&&(t.x=this.curve.x.getValue(e)),this.curve.y&&(t.y=this.curve.y.getValue(e)),this.curve.z&&"z"in t&&(t.z=this.curve.z.getValue(e)),this.curve.w&&"w"in t&&(t.w=this.curve.w.getValue(e)),t):this.curve.scalar?this.curve.scalar.getValue(e):null}}class v extends(m()){constructor(e,t,i,n){super(),this.coordinate={x:0,y:0},this.handleLeft={x:0,y:0},this.handleRight={x:0,y:0},this.interpolation="BEZIER",this.easing=null,this.nextFrame=null,this.set(e,t,i,n)}set(e,t,i,n){this.coordinate=e,this.handleLeft=t||e,this.handleRight=i||e,this.interpolation=n||"BEZIER"}getEasing(e,i){return"BEZIER"==e?t.bezier(this.coordinate,this.handleRight,i.handleLeft,i.coordinate):e=>{let t=i.coordinate.y-this.coordinate.y;return e=(e-this.coordinate.x)/(i.coordinate.x-this.coordinate.x),this.coordinate.y+e*t}}to(e,t){return null!=this.nextFrame&&this.nextFrame.coordinate.x==e.coordinate.x&&this.nextFrame.coordinate.y==e.coordinate.y||(this.easing=this.getEasing(this.interpolation,e),this.nextFrame=e),this.easing?this.easing(t):0}}class g extends r.Mesh{constructor(e){let t=new r.BufferGeometry,i=[],n=[],s=[];i.push(-1,1,0),i.push(1,1,0),i.push(1,-1,0),i.push(-1,-1,0),s.push(0,1),s.push(1,1),s.push(1,0),s.push(0,0),n.push(0,2,1,0,3,2);let o=new Float32Array(i),a=new Uint32Array(n),l=new Float32Array(s);t.setAttribute("position",new r.BufferAttribute(o,3)),t.setAttribute("uv",new r.BufferAttribute(l,2)),t.setIndex(new r.BufferAttribute(a,1)),e.vertexShader=e.vertexShader||"#define GLSLIFY 1\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nvoid main( void ) {\n    \n    vec3 pos = position;\n\n    pos.z = 1.0;\n    \n    gl_Position = vec4( pos, 1.0 );\n    \n    vUv = uv;\n    vColor = vec4( 1.0 );\n\n}",e.transparent=null==e.transparent||e.transparent,e.depthFunc=null!=e.depthFunc?e.depthFunc:r.NeverDepth,super(t,new r.ShaderMaterial(e)),this.uniforms=e.uniforms||{},this.frustumCulled=!1}resize(e){this.uniforms.resolution={value:e.canvasSize},this.uniforms.aspectRatio={value:e.canvasAspectRatio}}}class y extends(m()){constructor(e){super(),this.connected=!1,this.frameCurrent=0,this.frameStart=0,this.frameEnd=0,this.objects=[],this.actions=[],e&&(this.url=e,this.connect(this.url))}connect(e){this.url=e,this.ws=new WebSocket(this.url),this.ws.onopen=this.onOpen.bind(this),this.ws.onmessage=this.onMessage.bind(this),this.ws.onclose=this.onClose.bind(this),this.ws.onerror=e=>{console.error(e)}}syncJsonScene(e){let t=new XMLHttpRequest;t.onreadystatechange=()=>{4==t.readyState&&200==t.status&&this.onSyncScene(JSON.parse(t.response))},t.open("GET",e),t.send()}onSyncScene(e){this.actions.length=0,this.objects.length=0,e.actions.forEach((e=>{let t=new d(e.name),i=Object.keys(e.fcurve_groups);for(let n=0;n<i.length;n++){let s=i[n],r=new f(s);e.fcurve_groups[s].forEach((e=>{let t=new p;t.set(e.keyframes.map((e=>new v(e.c,e.h_l,e.h_r,e.i)))),r.setFCurve(t,e.axis)})),t.addFcurveGroup(r.name,r)}this.actions.push(t)})),e.objects.forEach((e=>{this.objects.push(e)})),this.emitEvent("update/scene",[this]),this.setTimeline(this.frameCurrent)}onSyncTimeline(e){this.setTimeline(e.current,e.start,e.end)}onOpen(e){this.connected=!0}onMessage(e){let t=JSON.parse(e.data);"sync/scene"==t.type?this.onSyncScene(t.data):"sync/timeline"==t.type&&this.onSyncTimeline(t.data)}onClose(e){this.disposeWS()}getActionNameList(e){for(let t=0;t<this.objects.length;t++)if(this.objects[t].name==e)return this.objects[t].actions;return[]}getAction(e){for(let t=0;t<this.actions.length;t++)if(this.actions[t].name==e)return this.actions[t];return null}getActionList(e){let t=[];return this.getActionNameList(e).forEach((e=>{let i=this.getAction(e);i&&t.push(i)})),t}getActionContainsAccessor(e){return this.actions.find((t=>Object.keys(t.curves).some((t=>t==e))))||null}setTimeline(e,t,i){this.frameCurrent=e,this.frameStart=t||this.frameStart,this.frameEnd=i||this.frameEnd,this.emitEvent("update/timeline",[this.frameCurrent,this.frameStart,this.frameEnd])}dispose(){this.disposeWS()}disposeWS(){this.ws&&(this.ws.close(),this.ws.onmessage=null,this.ws.onclose=null,this.ws.onopen=null,this.connected=!1)}}!function(e){e.mergeUniforms=function(...e){let t={};for(let i=0;i<e.length;i++)null!=e[i]&&Object.assign(t,e[i]);return t}}(c||(c={}));class E extends r.Mesh{constructor(e,t){let i=new r.PlaneBufferGeometry(2,2);t.vertexShader="#define GLSLIFY 1\nvarying vec2 vUv;\nuniform vec2 domPos;\nuniform vec2 domSize;\nuniform vec2 windowSize;\nuniform float aspectRatio;\n\nvoid main(  )\n{\n  float width = domSize.x / windowSize.x;\n\n  //左上( 0,0 )に\n  vec3 pos = position + vec3( 1.0,-1.0,0.0 );\n\n  //size\n  pos.x *= width;\n  pos.y *= ( width * aspectRatio ) * ( domSize.y / domSize.x );\n\n  pos += vec3( -1.0, 1.0, 0.0 );\n\n  pos += vec3( domPos.x / windowSize.x * 2.0, -domPos.y / windowSize.y * 2.0, 0.0 );\n\n  gl_Position = vec4( pos, 1.0 );\n  vUv = uv;\n}\n";let n=c.mergeUniforms(t.uniforms,{domPos:{value:new r.Vector2},domSize:{value:new r.Vector2},windowSize:{value:new r.Vector2},aspectRatio:{value:1}});t.uniforms=n,super(i,new r.ShaderMaterial(t)),this.frustumCulled=!1,this._uniforms=n,this.element=e,this.update()}get uniforms(){return this._uniforms}update(){let e=this.element.getBoundingClientRect();this._uniforms.windowSize.value.set(window.innerWidth,window.innerHeight),this._uniforms.aspectRatio.value=window.innerWidth/window.innerHeight,this._uniforms.domSize.value.set(e.width,e.height),this._uniforms.domPos.value.set(e.left,e.top)}}class w{constructor(){this.events=[]}addEventListener(e,t){this.events.push({type:e,listener:t})}dispatchEvent(e){e.target=this;for(let t=0;t<this.events.length;t++)e.type==this.events[t].type&&this.events[t].listener(e)}removeEventListener(e,t){for(let i=this.events.length;i>=0;i--)e==this.events[i].type&&t==this.events[i].listener&&this.events.splice(i,1)}}class S{constructor(e,t){this.renderTargets=[],this.renderer=e,this.dataSize=t.clone(),this.uniforms={dataSize:{value:this.dataSize}},this.tempDataLinear=this.createData({minFilter:r.LinearFilter,magFilter:r.LinearFilter}),this.tempDataNear=this.createData({minFilter:r.NearestFilter,magFilter:r.NearestFilter}),this.scene=new r.Scene,this.camera=new r.Camera,this.materials=[],this.mesh=new r.Mesh(new r.PlaneBufferGeometry(2,2)),this.scene.add(this.mesh)}get isSupported(){return this.renderer.extensions.get("OES_texture_float")}createInitializeTexture(){let e=new Float32Array(this.uniforms.dataSize.value.x*this.uniforms.dataSize.value.y*4),t=new r.DataTexture(e,this.uniforms.dataSize.value.x,this.uniforms.dataSize.value.y,r.RGBAFormat,r.FloatType);return t.needsUpdate=!0,t}createData(e,t){let i=navigator.userAgent,n=i.indexOf("iPhone")>=0||i.indexOf("iPad")>=0||"iPad"==navigator.platform||"MacIntel"==navigator.platform&&-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")&&void 0!==navigator.standalone,s={wrapS:r.ClampToEdgeWrapping,wrapT:r.ClampToEdgeWrapping,minFilter:r.NearestFilter,magFilter:r.NearestFilter,format:r.RGBAFormat,type:n?r.HalfFloatType:r.FloatType,stencilBuffer:!1,depthBuffer:!1},o=null,a=null;e&&(e.isDataTexture?(o=e,t&&(a=t)):a=e),a&&(s.wrapS=a.wrapS||s.wrapS,s.wrapT=a.wrapT||s.wrapT,s.minFilter=a.minFilter||s.minFilter,s.magFilter=a.magFilter||s.magFilter,s.format=a.format||s.format,s.type=a.type||s.type,s.stencilBuffer=a.stencilBuffer||s.stencilBuffer,s.depthBuffer=a.depthBuffer||s.depthBuffer);let l=new r.WebGLRenderTarget(this.uniforms.dataSize.value.x,this.uniforms.dataSize.value.y,s),h={buffer:l};if(this.renderTargets.push(l),o){let e=this.createKernel({fragmentShader:"#define GLSLIFY 1\nuniform sampler2D tex;\nvarying vec2 vUv;\n\nvoid main() {\n    gl_FragColor = texture2D(tex,vUv);\n}",uniforms:{tex:{value:o}}});this.compute(e,h)}return h}createKernel(e){let t=c.mergeUniforms(e.uniforms,this.uniforms);e.uniforms=t,e.vertexShader=e.vertexShader||"#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n    gl_Position = vec4( position, 1.0 );\n    vUv = uv;\n}";let i=new r.ShaderMaterial(e);return this.materials.push(i),{material:i,uniforms:e.uniforms}}compute(e,t,i){let n;n=t.buffer.texture.magFilter==r.LinearFilter?this.tempDataLinear:this.tempDataNear,this.mesh.material=e.material;let s=this.renderer.getRenderTarget();this.renderer.setRenderTarget(n.buffer),this.renderer.render(this.scene,i||this.camera),this.swapBuffers(t,n),this.renderer.setRenderTarget(s)}swapBuffers(e,t){let i=e.buffer;e.buffer=t.buffer,t.buffer=i}dispose(){this.mesh.geometry.dispose();for(let e=0;e<this.materials.length;e++)this.materials[e].dispose();this.scene.remove(this.mesh),this.tempDataLinear.buffer.dispose(),this.tempDataNear.buffer.dispose()}resizeData(e){this.dataSize.copy(e);for(let t=0;t<this.renderTargets.length;t++)this.renderTargets[t].setSize(e.x,e.y)}}class b{constructor(e){this.target=e,this.scrollVel=new r.Vector2}update(){this.scrollVel.multiplyScalar(.96);let e=new r.Vector3(this.scrollVel.y,this.scrollVel.x,0).normalize(),t=(new r.Quaternion).setFromAxisAngle(e,this.scrollVel.length());t.multiply(this.target.quaternion),this.target.quaternion.copy(t)}addVelocity(e){this.scrollVel.addVectors(this.scrollVel,e.multiplyScalar(.001))}}class x{constructor(e,t,i){this.renderer=e,this.scene=new r.Scene,this.camera=new r.OrthographicCamera(-1,1,1,-1),this.screen=new r.Mesh(i||new r.PlaneBufferGeometry(2,2)),this.scene.add(this.screen),t.vertexShader=t.vertexShader||"#define GLSLIFY 1\nvarying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = vec4( position, 1.0 );\n}   ",t.uniforms=t.uniforms||{},t.uniforms.resolution={value:new r.Vector2},this.effect={material:new r.ShaderMaterial(t)}}render(e,t=null){let i=this.renderer.getRenderTarget(),n=this.effect,s=n.material,r=s.uniforms;if(e){let t=Object.keys(e);for(let i=0;i<t.length;i++)r[t[i]]?r[t[i]].value=e[t[i]]:(r[t[i]]={value:e[t[i]]},n.material.needsUpdate=!0,n.material.uniforms=r)}t?r.resolution.value.set(t.width,t.height):this.renderer.getSize(r.resolution.value),this.screen.material=s,this.renderer.setRenderTarget(t),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(i)}}class P{constructor(e){this.isAutoMove=!1,this.delaySpeed=.1,this.dragDelaySpeed=.4,this.isTouching=!1,this.deltaMem=0,this.scrollReady=!1,this.sumDelta=0,this._scrollPos=0,this._scrollPosMem=0,this._scrollPercentage=0,this._scrollPosDelay=0,this._scrollPercentageDelay=0,this.dragStop=!1,this.dragUnlockReady=!0,this.parentElement=e,this.parentElementHeight=e.getBoundingClientRect().height,this.sections=[],this.caughtSection=null,this.animator=new h,this.animator.add({name:"scrollPos",initValue:0,easing:t.sigmoid()})}get scrollPos(){return this._scrollPos}get scrollPosDelay(){return this._scrollPosDelay}get scrollPercentage(){return this._scrollPercentage}get scrollPercentageDelay(){return this._scrollPercentageDelay}get scrollTimelinePercentage(){let e=0;for(let t=0;t<this.sections.length;t++){let i=this.sections[t],n=this.sections[t-1],s=1-Math.max(0,i.element.offsetTop-this.scrollPosDelay+(i.bottom?i.rect.height-window.innerHeight:0))/((n?n.rect.height-(n.bottom?window.innerHeight:0):0)+(i.bottom?i.rect.height-window.innerHeight:0)||1);if(s=Math.max(0,s),e+=s,s<1)break}return e/this.sections.length}add(e){return this.sections.push(e),this.sortSections(),e}sortSections(){this.sections.sort(((e,t)=>e.rect.y>t.rect.y?1:-1));for(let e=0;e<this.sections.length;e++)this.sections[e].timelinePercentage=(e+1)/this.sections.length}get(e){for(let t=0;t<this.sections.length;t++)if(this.sections[t].name==e)return this.sections[t];return console.warn('section "'+e+'" is not exist.'),null}update(e){this.updateParentElement(),this.updateScrollPos(e),this.applyParentElementTransform(),this.sumDelta=0}updateScrollPos(e){this.updateAutoMove(e),this.addScrollPos(),this.calcScrollProperties(e)}updateAutoMove(e){if(this.animator.update(e),this.isAutoMove){let e=this.animator.get("scrollPos");e&&(this.sumDelta=e-this.scrollPos)}}addScrollPos(){if(this.checkUnlockStopScroll(this.sumDelta)){let e=this.checkThrow(this.sumDelta);null!==e?this._scrollPos=e:this._scrollPos+=this.sumDelta,this._scrollPos=Math.max(Math.min(this._scrollPos,this.parentElementHeight-window.innerHeight),0)}}checkUnlockStopScroll(e){let t=0,i=!1;if(this.caughtSection){let n=this.scrollPos-this.scrollPosDelay;if((e*n<0||Math.abs(n)<10||this.isAutoMove)&&(e<0?(-e>(this.caughtSection.startScrollUp||0)||this.isAutoMove)&&(t=-1):e>0&&(e>(this.caughtSection.startScrollDown||0)||this.isAutoMove)&&(t=1)),0!=t&&this.caughtSection.events&&this.caughtSection.events.onStartScroll){let i,n={scroller:this,section:this.caughtSection,scrollMode:this.isAutoMove?"auto":"manual",scrollDelta:e,scrollPower:Math.abs(e)},s=this.caughtSection.events.onStartScroll.common&&this.caughtSection.events.onStartScroll.common(n);-1==t&&(i=this.caughtSection.events.onStartScroll.up&&this.caughtSection.events.onStartScroll.up(n)),1==t&&(i=this.caughtSection.events.onStartScroll.down&&this.caughtSection.events.onStartScroll.down(n)),!1!==s&&!1!==i||(t=0)}i=0!=t}else i=!0;return t&&(this.caughtSection=null),i}checkThrow(e){for(let t=0;t<this.sections.length;t++){let i=this.sections[t];i.updateRect(this._scrollPos);let n=this.checkThrowSectionEvents(i,e);if(null!==n)return this.caughtSection=i,this.isAutoMove?null:n}return null}checkThrowSectionEvents(e,t){let i=e.getScrollPercentage(),n=e.getScrollPercentage(t);if(e.events){let s={scroller:this,section:e,scrollMode:this.isAutoMove?"auto":"manual",scrollDelta:t,scrollPower:Math.abs(t)};if(e.events.onArrivals)for(let t=0;t<e.events.onArrivals.length;t++){let r=e.events.onArrivals[t],o=this.checkThrowLine(i,n,r.percentage);0!=o&&(r.event.common&&r.event.common(s),o<0?r.event.up&&r.event.up(s):r.event.down&&r.event.down(s))}}return e.stop&&this.checkThrowLine(i,n,1)?(this.dragUnlockReady=!1,e.element.offsetTop+(e.bottom?e.rect.height-window.innerHeight:0)):null}checkThrowLine(e,t,i){return e<i&&i<=t?1:e>i&&i>=t?-1:e==i&&i==t?2:0}calcScrollProperties(e){this._scrollPosDelay+=(this._scrollPos-this._scrollPosDelay)*(this.isTouching&&!this.caughtSection?this.dragDelaySpeed:this.delaySpeed)*Math.min(1,60*e),this._scrollPercentage=this.scrollPosToPerecntage(this.scrollPos),this._scrollPercentageDelay=this.scrollPosToPerecntage(this.scrollPosDelay)}scrollPosToPerecntage(e){return e/(this.parentElementHeight-window.innerHeight)}updateParentElement(){this.parentElementHeight=this.parentElement.getBoundingClientRect().height}applyParentElementTransform(){this.parentElement.style.transform="translate3d( 0,"+-this.scrollPosDelay.toString()+"px, 0 )"}scroll(e){this.deltaMem=(this.deltaMem+e)/2,this.sumDelta+=e}catch(){this.isAutoMove||(this.isTouching=!0,this.deltaMem=0,this.caughtSection||(this._scrollPos=this._scrollPosDelay))}drag(e){this.isTouching&&this.scroll(e)}release(e=10){this.isTouching&&(this.isTouching=!1,this.caughtSection||this.scroll(this.deltaMem*e))}autoMove(e){let t=0;if(e.target.isPageScrollerSection){let i=e.target,n=e.bottom?i.rect.height-window.innerHeight:0;t=i.element.offsetTop+n}else if("string"==typeof e.target){let i=this.get(e.target);if(i){let n=e.bottom?i.rect.height-window.innerHeight:0;t=i.element.offsetTop+n}}else"number"==typeof e.target&&(t=e.target);this.animator.setValue("scrollPos",this._scrollPos),this.animator.animate("scrollPos",t,e.duration,(()=>{e.callBack&&e.callBack(),this.isAutoMove=!1}),e.easing),this.sumDelta=(t-this.sumDelta)/Math.abs(t-this.sumDelta)*1e-5,this.isAutoMove=!0}}class T{constructor(e){this.timelinePercentage=0,this.name=e.name,this.element=e.element,this.rect=this.element.getBoundingClientRect(),this.stop=e.stop,this.events=e.events,this.bottom=e.bottom,this.startScrollDown=e.startScrollDown||0,this.startScrollUp=e.startScrollUp||0,this.updateRect(0)}get isPageScrollerSection(){return!0}updateRect(e){this.rect={x:this.element.offsetLeft,y:this.element.offsetTop-e,width:this.element.offsetWidth,height:this.element.offsetHeight}}getScrollPercentage(e){let t=this.bottom?this.rect.height-window.innerHeight:0,i=this.rect.y+t-(e||0),n=this.bottom?this.rect.height:window.innerHeight,s=Math.min(1,1-i/n),r=this.bottom?window.innerHeight:this.rect.height;return s+Math.max(0,-i/r)}}class A{constructor(e,t,i){this.obj=e,this.baseTransform={position:this.obj.position.clone(),rotation:this.obj.quaternion.clone(),scale:this.obj.scale.clone()},this.transform=t,i||(this.transform.position&&this.transform.position.add(this.obj.position),this.transform.rotation&&this.transform.rotation.multiply(this.obj.quaternion))}updateTransform(e){this.transform.position&&this.obj.position.copy(this.baseTransform.position.clone().lerp(this.transform.position,e)),this.transform.rotation&&this.obj.quaternion.copy(this.baseTransform.rotation.clone().slerp(this.transform.rotation,e)),this.transform.scale&&this.obj.scale.copy(this.baseTransform.scale.clone().multiplyScalar(this.transform.scale*e+1-e))}}class L{constructor(){this.variables={},this.time=0}add(e){if(0!=e.keyframes.length)return this.variables[e.name]={keyframes:e.keyframes,lerpFunc:e.customLerp,easing:e.easing,value:null},this.variables[e.name].keyframes.sort(((e,t)=>e.time<t.time?-1:1)),this.variables[e.name].lerpFunc||(this.variables[e.name].lerpFunc=i.getLerpFunc(e.keyframes[0].value)),this.calc(),e.name;console.warn('"'+e.name+'"',"Keyframe length is 0!!")}get(e){return this.variables[e]?this.variables[e].value:(console.warn('"'+e+'" is not exist'),null)}getVariableObject(e){return this.variables[e]?this.variables[e]:(console.warn('"'+e+'" is not exist'),null)}update(e){this.time=e,this.calc()}calc(){let e=Object.keys(this.variables);for(let t=0;t<e.length;t++){let i=this.variables[e[t]],n=i.keyframes,s=null,r=null,o=Math.max(n[0].time,Math.min(n[n.length-1].time,this.time)),a=null;if(1==n.length)o=n[0].time,s=r=n[0];else{for(let e=0;e<n.length-1&&(s=n[e],r=n[e+1],a=s.easing,!(s.time<=o&&o<=r.time));e++);null!=s&&null!=r&&(o=(o-s.time)/(r.time-s.time))}a?o=a(o):i.easing?o=i.easing(o):this.defaultEasing&&(o=this.defaultEasing(o)),i.lerpFunc?(null!=s&&null!=r&&(i.value=i.lerpFunc(s.value,r.value,o)),!1===i.value&&console.log('error at "'+e[t]+'"')):console.warn('"'+e[t]+'"',"lerp function is not set.")}}}class R extends r.EventDispatcher{constructor(){super()}goHome(){this.dispatchEvent({type:"gohome"})}wait(e){return new Promise(((t,i)=>{const n=()=>{i(),this.removeEventListener("gohome",n)};this.addEventListener("gohome",n),setTimeout((()=>{this.removeEventListener("gohome",n),t()}),1e3*e)}))}}})(),s})()));